@using SDMetaUI.Models;

<div @ref="containerRef" @onkeydown="KeyboardEventHandler">
	<HxModal @ref="hxModal" Fullscreen="ModalFullscreen.Always" Backdrop="ModalBackdrop.False">
		<BodyTemplate>
			<div @onclick="() => hxModal.HideAsync()" style="width: 100%; height: 100%; background-color:gba(0, 0, 0, 0.1);" class="text-center" tabindex="0">
				<img src="@selectedFile.GetImageUrl()" class="img-fit" />
			</div>
		</BodyTemplate>
	</HxModal>
</div>
@code {
	[Parameter]
	public PngFileViewModel selectedFile { get; set; }
	[Parameter]
	public EventCallback<KeyboardEventArgs> onLeft { get; set; }
	[Parameter]
	public EventCallback<KeyboardEventArgs> onRight { get; set; }

	private ElementReference containerRef;
	private HxModal? hxModal;

	public Task ShowAsync()
	{
		return hxModal.ShowAsync();
	}

	private async void KeyboardEventHandler(KeyboardEventArgs args)
	{
		if (args.Code == "ArrowLeft") onLeft.InvokeAsync(args);
		else if (args.Code == "ArrowRight") onRight.InvokeAsync(args);
	}

	protected override async Task OnAfterRenderAsync(bool firstRender)
	{
		if (firstRender)
		{
			await containerRef.FocusAsync();
		}
	}
}
